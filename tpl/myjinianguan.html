<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>我的纪念馆</title>
    <script src="../js/mui.min.js"></script>
    <link href="../css/mui.min.css" rel="stylesheet"/>
     <link href="../css/index.css" rel="stylesheet"/>
     <link href="../css/list.css" rel="stylesheet"/>     
    <script src="../js/jquery-1.10.2.js" type="text/javascript" charset="utf-8"></script>
    <style type="text/css">
	.editMem{
	/*display: none;*/
		/*text-align: right;*/
		/*border: 1px red solid;*/
		margin-top: 6px;
		background: #FFFFFF;
		height: 50px;
		line-height:50px;
	}
	.editMem a{
		display: inline-block;
		margin-right: 8px;
		background: #01A2FF;
		color: #f7f7f7;
		border: 1px #e1e1e1 solid;
		width: 60px;
		height: 30px;
		text-align: center;
		line-height: 30px;
		border-radius: 2px;
	}
.list1{
		margin-left:12px;
		padding-top: 6px;
		border-top: 1px #e1e1e1 solid;
	}
	.list1 h4{
		color: #000000;
		font-family: "微软雅黑";
		font-size: 16px;
	}
	a:active { 
		background: #274770;
		text-decoration:none; 
} 
	
</style>
    
	<script type="application/javascript">
		var imgBase = "http://img.yunji128.com/";
		var urlBase = 'http://api.yunji128.com/homage';
		$.ajax({  
			headers: {
		        tokenInfo: window.localStorage.getItem("tokenInfo")
		    },
	        type: "GET",  
	        url: urlBase + "/api/user/userInfoByMe",  
	        data: {},  
	        dataType: "json",  
	        success: function (data) {
	        	if(data.code=='SUCCESS'){
	        		$("#nickname").html(data.result.nickname);
	        		$("#headImg").attr("src",imgBase + data.result.headImg);
	        	}
	        	else if(data.code=='PleaseLogin'){
	        		window.location.href='login.html';
	        	}
	        	else{
	        		alert(data.message);
	        	}
	        },  
	        error: function (message) {  
	            alert("提交数据失败！");  
	        }  
   		});
	</script>
	
</head>
<body>
 	<!--<header class="mui-bar mui-bar-nav header">
 	    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>   
		 <h1 class="mui-title">我的纪念馆</h1>
 	</header>-->
 
  <div class="mui-content">
  	
  <div class="mybanner"><img id="headImg" src=""/><h4 id="nickname"></h4></div>  
  
<!--  选项卡-->

  
 <div class="mui-slider">
     <div class="mui-slider-indicator mui-segmented-control mui-segmented-control-inverted">
         <a class="mui-control-item" href="#item1">私人馆</a>
         <a class="mui-control-item" href="#item2">双人馆</a>
         <a class="mui-control-item" href="#item3">名人馆</a>
     </div>
       <div id="sliderProgressBar" class="mui-slider-progress-bar mui-col-xs-4"></div>
     <div class="mui-slider-group">
         
         
 <div id="item1" class="mui-slider-item mui-control-content mui-active">
   <ul class="mui-table-view" id="mpersonal">
   	<script type="application/javascript">
   		$("#editPhone").click(function(){
 				window.location.href="upMemorPhone.html";
   			
   		})
   			$("#editPepo").on("tap",function(){
 	
 				window.location.href="reviseLife.html";
 		})
   				$("#deletMem").on("tap",function(){
 	
 				window.location.href="delMemorial.html";
 		})
   	</script>
              
<script type="application/javascript">
			var imgBase = "http://img.yunji128.com/";
			var urlBase = 'http://api.yunji128.com/homage';
 			$.ajax({
		      type: "GET",
			  headers: {
	           	tokenInfo: window.localStorage.getItem("tokenInfo")
	    	  },
		      contentType: "application/json",
		      dataType: "json",
		      url: urlBase+"/api/memorial/mylist?currentPage=1&limit=50&peopleNumber=1", //这里是网址
		      success:function(data){
				var listPersonal = data.result.content;
				//alert(personallist)
				var memorialContent = "";
				$.each(listPersonal, function(){     
				    memorialContent +='<li class="list1"><a href="javascript:info('+this.memorialId+');"><h4>'+this.memorialName+'</h4>'+
					'<img class="mui-media-object mui-pull-left" src="'+imgBase+this.headImg+'"></a>'+
        			'<div class="mui-media-body"><ul class="smallul"><li>馆号：<span>'+this.userId+'</span></li><li>建馆人：<span>'+this.nickname +'</span></li></ul>'+ 
	 			 	'<ul class="smallul"><li>祭拜数：<span>'+this.worshipCount +'</span></li><li>建馆时间：<span>'+this.rowAddTime +'</span></li></ul></div><div class="editMem"><a id="editPhone" href="javascript:phnoInfo('+this.memorialId+');">相册</a><a id="editPepo" href="javascript:pepoleInfo('+this.memorialId+');">编辑</a><a id="muxiangMem" href="javascript:muxiangInfo('+this.memorialId+');">墓像</a><a id="deletMem" href="javascript:deleteInfo('+this.memorialId+');">删除</a></div></li>'
	 			 });
				document.getElementById('mpersonal').innerHTML = memorialContent;
			},
	      error: function (message) {
	      	//alert("读取私人馆列表失败");
	      }
    });

</script>     
         
   </ul>
</div>
         
 
   
  <div id="item2" class="mui-slider-item mui-control-content">
      <ul class="mui-table-view" id="mcelebrity">
 
	<script type="application/javascript">
 		 $.ajax({
		      type: "GET",
		      contentType: "application/json",
		      dataType: "json",
			  headers: {
	           	tokenInfo: window.localStorage.getItem("tokenInfo")
	    	  },
		      url: urlBase+"/api/memorial/mylist?currentPage=1&limit=50&peopleNumber=2", //这里是网址
		      success:function(data){
				var listcelebrity = data.result.content;
				console.log(listcelebrity)
				var memorialcelebrity = "";
				$.each(listcelebrity, function(){     
				    memorialcelebrity +='<li class="mui-media list1"><a href="javascript:info('+this.memorialId+');"><h4>'+this.memorialName+'</h4>'+
					'<img class="mui-media-object mui-pull-left" src="'+imgBase+this.headImg+'">'+
        			'<div class="mui-media-body"><ul class="smallul"><li>馆号：<span>'+this.userId+'</span></li><li>建馆人：<span>'+this.nickname +'</span></li></ul>'+ 
	 			 	'<ul class="smallul"><li>祭拜数：<span>'+this.worshipCount +'</span></li><li>建馆时间：<span>'+this.rowAddTime +'</span></li></ul></div></a><div class="editMem"><a id="editPhone" href="javascript:phnoInfo('+this.memorialId+');">相册</a><a id="editPepo" href="javascript:pepoleInfo('+this.memorialId+');">编辑</a><a id="muxiangMem" href="javascript:muxiangInfo('+this.memorialId+');">墓像</a><a id="deletMem" href="javascript:deleteInfo('+this.memorialId+');">删除</a></div></li>'
	 			 });
				document.getElementById('mcelebrity').innerHTML = memorialcelebrity;
			},
	      	error: function (message) {
	      	//alert("读取公益馆列表失败");
	     		 }
   			});
	</script> 
       </ul>
</div>
         
         <div id="item3" class="mui-slider-item mui-control-content nav1">
             <ul class="mui-table-view" id="renqi">
      	<script type="application/javascript">
 		 $.ajax({
		      type: "GET",
		      contentType: "application/json",
		      dataType: "json",
			  headers: {
	           	tokenInfo: window.localStorage.getItem("tokenInfo")
	    	  },
		      url: urlBase+"/api/memorial/mylist?memorialType=celebrity&currentPage=1&limit=50", //这里是网址
		      success:function(data){
				var listrenqi = data.result.content;
				console.log(listrenqi)
				var memorialrenqi = "";
				$.each(listrenqi, function(){     
				    memorialrenqi +='<li class="mui-media list1"><a href="javascript:info('+this.memorialId+');"><h4>'+this.memorialName+'</h4>'+
					'<img class="mui-media-object mui-pull-left" src="'+imgBase+this.headImg+'">'+
        			'<div class="mui-media-body"><ul class="smallul"><li>馆号：<span>'+this.userId+'</span></li><li>建馆人：<span>'+this.nickname +'</span></li></ul>'+ 
	 			 	'<ul class="smallul"><li>祭拜数：<span>'+this.worshipCount +'</span></li><li>建馆时间：<span>'+this.rowAddTime +'</span></li></ul></div></a><div class="editMem"><a id="editPhone" href="javascript:phnoInfo('+this.memorialId+');">相册</a><a id="editPepo" href="javascript:pepoleInfo('+this.memorialId+');">编辑</a><a id="muxiangMem" href="javascript:muxiangInfo('+this.memorialId+');">墓像</a><a id="deletMem" href="javascript:deleteInfo('+this.memorialId+');">删除</a></div></li>'
	 			 });
				document.getElementById('renqi').innerHTML = memorialrenqi;
			},
	      error: function (message) {
	      	//alert("读取纪念馆列表失败");
	     	}
   		  });
	</script>         
                
             </ul>
         </div>
         
     </div>
 </div>
  
  <!--列表-->
  
<!--<nav class="mui-bar mui-bar-tab">
      <a class="mui-tab-item mui-active" id="jinianguan">
          <span class="mui-icon mui-icon-home"></span>
          <span class="mui-tab-label">纪念馆</span>
      </a>
      <a class="mui-tab-item" id="jiapu">
          <span class="mui-icon mui-icon-map"></span>
          <span class="mui-tab-label">家谱圈</span>
      </a>
      <a class="mui-tab-item" id="xingshi">
          <span class="mui-icon mui-icon-navigate"></span>
          <span class="mui-tab-label">姓氏起源</span>
      </a>
      <a class="mui-tab-item" id="personal">
          <span class="mui-icon mui-icon-contact"></span>
          <span class="mui-tab-label">个人中心</span>
      </a>
  </nav>-->

 
<script src="../js/navJump.js"></script>
<script type="application/javascript">
	function info(id){
		var urlBase = 'http://api.yunji128.com/homage';
		var imgBase = 'http://img.yunji128.com/';
		$.ajax({  
			headers: {
		        tokenInfo: window.localStorage.getItem("tokenInfo")
		    },
	        type: "POST",  
	        url: urlBase + "/api/memorial/checkAccess?memorialId="+id,  
	        data: {},  
	        dataType: "json",  
	        success: function (data) {
	        	if(data.code=='SUCCESS'){
	        		if(data.result){
	        			window.location.href="jinianguanDetail.html?memorialId="+id;
	        		}else{
	        			//
	        			alert("请输入密码");
	        		}
	        	}
	        	else{
	        		alert(data.message);
	        	}
	        },  
	        error: function (message) {  
	            alert("提交数据失败！");  
	        }  
	   });
	}
	
		function phnoInfo(id){
		var urlBase = 'http://api.yunji128.com/homage';
		var imgBase = 'http://img.yunji128.com/';
		$.ajax({  
			headers: {
		        tokenInfo: window.localStorage.getItem("tokenInfo")
		    },
	        type: "POST",  
	        url: urlBase + "/api/memorial/checkAccess?memorialId="+id,  
	        data: {},  
	        dataType: "json",  
	        success: function (data) {
	        	if(data.code=='SUCCESS'){
	        		if(data.result){
	        			window.location.href="upMemorPhone.html?memorialId="+id;
	        		}else{
	        			//
	        			alert("请输入密码");
	        		}
	        	}
	        	else{
	        		alert(data.message);
	        	}
	        },  
	        error: function (message) {  
	            alert("提交数据失败！");  
	        }  
	   });
	}
		
		function pepoleInfo(id){
		var urlBase = 'http://api.yunji128.com/homage';
		var imgBase = 'http://img.yunji128.com/';
		$.ajax({  
			headers: {
		        tokenInfo: window.localStorage.getItem("tokenInfo")
		    },
	        type: "POST",  
	        url: urlBase + "/api/memorial/checkAccess?memorialId="+id,  
	        data: {},  
	        dataType: "json",  
	        success: function (data) {
	        	if(data.code=='SUCCESS'){
	        		if(data.result){
	        			window.location.href="reviseLife.html?memorialId="+id;
	        		}else{
	        			//
	        			alert("请输入密码");
	        		}
	        	}
	        	else{
	        		alert(data.message);
	        	}
	        },  
	        error: function (message) {  
	            alert("提交数据失败！");  
	        }  
	   });
	}
		
	function deleteInfo(id){
		var urlBase = 'http://api.yunji128.com/homage';
		var imgBase = 'http://img.yunji128.com/';
		$.ajax({  
			headers: {
		        tokenInfo: window.localStorage.getItem("tokenInfo")
		    },
	        type: "POST",  
	        url: urlBase + "/api/memorial/checkAccess?memorialId="+id,  
	        data: {},  
	        dataType: "json",  
	        success: function (data) {
	        	if(data.code=='SUCCESS'){
	        		if(data.result){
	        			window.location.href="delMemorial.html?memorialId="+id;
	        		}else{
	        			//
	        			alert("请输入密码");
	        		}
	        	}
	        	else{
	        		alert(data.message);
	        	}
	        },  
	        error: function (message) {  
	            alert("提交数据失败！");  
	        }  
	   });
	}	
		
	
	function muxiangInfo(id){
		var urlBase = 'http://api.yunji128.com/homage';
		var imgBase = 'http://img.yunji128.com/';
		$.ajax({  
			headers: {
		        tokenInfo: window.localStorage.getItem("tokenInfo")
		    },
	        type: "POST",  
	        url: urlBase + "/api/memorial/checkAccess?memorialId="+id,  
	        data: {},  
	        dataType: "json",  
	        success: function (data) {
	        	if(data.code=='SUCCESS'){
	        		if(data.result){
	        			window.location.href="muxiangInfo.html?memorialId="+id;
	        		}else{
	        			//
	        			alert("请输入密码");
	        		}
	        	}
	        	else{
	        		alert(data.message);
	        	}
	        },  
	        error: function (message) {  
	            alert("提交数据失败！");  
	        }  
	   });
	}	
	
</script>
</body>
</html>